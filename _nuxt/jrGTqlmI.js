import{g as h,h as v}from"./DB6zgcZV.js";import{r as n}from"./Dr2B6r8K.js";const m="HeadingBio",$=h("useProfileStore",()=>{const t=v(),s=n(null),o=n(null),e=n(!1),d=async()=>{e.value=!0,await t.fetchUser();const a=t.user,r=await $fetch("/api/profile/list",{headers:{Authorization:`Bearer ${a==null?void 0:a.token}`}});if(!r){e.value=!1;return}s.value=r,o.value=null,e.value=!1},i=async a=>{var c;e.value=!0;const r=(c=s.value)==null?void 0:c.find(l=>l.username===a);if(r){o.value=r,e.value=!1;return}const u=await $fetch("/api/profile",{query:{username:`@${a}`}});if(!u){e.value=!1;return}const f=u.components.find(l=>l.type===m);o.value=f?f.props:null,e.value=!1};return{profiles:s,profile:o,loading:e,fetchProfiles:d,fetchProfile:i,addProfile:async a=>{var r;if(e.value=!0,t.user===null)throw e.value=!1,new Error("User is not logged in");await $fetch("/api/profile/createOrUpdate",{method:"POST",body:{username:a.username,bio:a.bio,image:a.image??"",socials:a.socials},headers:{Authorization:`Bearer ${(r=t.user)==null?void 0:r.token}`}}),await i(a.username),e.value=!1},deleteProfile:async a=>{var r;if(e.value=!0,t.user===null)throw e.value=!1,new Error("User is not logged in");await $fetch("/api/profile/delete",{method:"POST",headers:{Authorization:`Bearer ${(r=t.user)==null?void 0:r.token}`},body:{username:`@${a}`}}),e.value=!1}}});export{$ as u};
