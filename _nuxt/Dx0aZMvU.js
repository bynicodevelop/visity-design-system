import{e as c,f as d}from"./DiCQvqgN.js";import{r as s}from"./DYHvSiQ9.js";const h="HeadingBio",P=c("useProfileStore",()=>{const t=d(),l=s(null),o=s(null),e=s(!1),u=async()=>{e.value=!0,await t.fetchUser();const a=t.user,r=await $fetch("/api/profile/list",{headers:{Authorization:`Bearer ${a==null?void 0:a.token}`}});if(!r){e.value=!1;return}l.value=r,o.value=null,e.value=!1},n=async a=>{e.value=!0;const r=await $fetch("/api/profile",{query:{username:`@${a}`}});if(!r){e.value=!1;return}const i=r.components.find(f=>f.type===h);o.value=i?i.props:null,e.value=!1};return{profiles:l,profile:o,loading:e,fetchProfiles:u,fetchProfile:n,addProfile:async a=>{var r;if(e.value=!0,t.user===null)throw e.value=!1,new Error("User is not logged in");await $fetch("/api/profile/createOrUpdate",{method:"POST",body:{username:a.username,bio:a.bio,image:a.image??"",socials:a.socials},headers:{Authorization:`Bearer ${(r=t.user)==null?void 0:r.token}`}}),await n(a.username),e.value=!1},deleteProfile:async a=>{var r;if(e.value=!0,t.user===null)throw e.value=!1,new Error("User is not logged in");await $fetch("/api/profile/delete",{method:"POST",headers:{Authorization:`Bearer ${(r=t.user)==null?void 0:r.token}`},body:{username:`@${a}`}}),e.value=!1}}});export{P as u};
