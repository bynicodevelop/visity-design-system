import{g as v,h as m}from"./DUbpLHlo.js";import{r as i}from"./Dr2B6r8K.js";const p="HeadingBio",y=v("useProfileStore",()=>{const r=m(),l=i(null),t=i(null),e=i(!1),d=async()=>{e.value=!0,await r.fetchUser();const a=r.user,s=await $fetch("/api/profile/list",{query:{uid:a==null?void 0:a.id}});if(!s){e.value=!1;return}l.value=s,t.value=null,e.value=!1},n=async a=>{var c;e.value=!0;const s=(c=l.value)==null?void 0:c.find(o=>o.username===a);if(s){t.value=s,e.value=!1;return}const u=await $fetch("/api/profile",{query:{username:`@${a}`}});if(!u){e.value=!1;return}const f=u.components.find(o=>o.type===p);t.value=f?f.props:null,e.value=!1};return{profiles:l,profile:t,loading:e,fetchProfiles:d,fetchProfile:n,addProfile:async a=>{var s;if(e.value=!0,r.user===null)throw e.value=!1,new Error("User is not logged in");await $fetch("/api/profile/createOrUpdate",{method:"POST",body:{uid:(s=r.user)==null?void 0:s.id,username:a.username,bio:a.bio,image:a.image??"",socials:a.socials}}),await n(a.username),e.value=!1},deleteProfile:async a=>{var s;if(e.value=!0,r.user===null)throw e.value=!1,new Error("User is not logged in");await $fetch("/api/profile/delete",{method:"POST",body:{username:`@${a}`,uid:(s=r.user)==null?void 0:s.id}}),e.value=!1}}});export{y as u};
